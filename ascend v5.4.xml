<?xml version="1.0" encoding="utf-8"?>
<Program name="ascend v5.4">
  <Variables>
    <Variable name="`Ap" number="-0" />
    <Variable name="`Pe" number="-0" />
    <Variable name="`max_TWR" number="-0" />
    <Variable name="Q" number="-0" />
    <Variable name="`max_maxQ" number="-0" />
    <Variable name="`ascent_angle_k" number="-0" />
    <Variable name="~ON" number="-0" />
    <Variable name="`ApPe">
      <Items />
    </Variable>
    <Variable name="``orbit_params" number="-0" />
    <Variable name="`inclination" number="-0" />
    <Variable name="Ap" number="-0" />
    <Variable name="Pe" number="-0" />
    <Variable name="max_TWR" number="-0" />
    <Variable name="~PHASE" number="-0" />
    <Variable name="~io" number="-0" />
    <Variable name="~ASK_INPUT" number="-0" />
    <Variable name="~AUTO" number="-0" />
    <Variable name="G™" number="0" />
    <Variable name="display" number="0" />
    <Variable name="stage_fuel_percent_mass" number="0" />
    <Variable name="e™" number="0" />
    <Variable name="circ_∆V" number="0" />
  </Variables>
  <Instructions>
    <Event event="FlightStart" id="0" style="flight-start" pos="79.15079,-48.1514" />
    <Comment id="1" style="comment">
      <Constant style="comment-text" canReplace="false" text="Default Orbit params" />
    </Comment>
    <SetVariable id="2" style="set-variable">
      <Variable list="false" local="false" variableName="`Ap" />
      <BinaryOp op="*" style="op-mul">
        <Constant text="90" />
        <Constant text="1000" />
      </BinaryOp>
    </SetVariable>
    <SetVariable id="3" style="set-variable">
      <Variable list="false" local="false" variableName="`Pe" />
      <Variable list="false" local="false" variableName="`Ap" />
    </SetVariable>
    <SetVariable id="4" style="set-variable">
      <Variable list="false" local="false" variableName="`inclination" />
      <Constant text="0" />
    </SetVariable>
    <Comment id="5" style="comment">
      <Constant style="comment-text" canReplace="false" text="Ascent params" />
    </Comment>
    <SetVariable id="6" style="set-variable">
      <Variable list="false" local="false" variableName="`max_TWR" />
      <Constant text="5" />
    </SetVariable>
    <SetVariable id="7" style="set-variable">
      <Variable list="false" local="false" variableName="`max_maxQ" />
      <Constant text="50000" />
    </SetVariable>
    <SetVariable id="8" style="set-variable">
      <Variable list="false" local="false" variableName="`ascent_angle_k" />
      <Constant text="0.4" />
    </SetVariable>
    <SetVariable id="9" style="set-variable">
      <Constant text="" />
      <Constant text="60" />
    </SetVariable>
    <Comment id="10" style="comment">
      <Constant style="comment-text" canReplace="false" text="Constants" />
    </Comment>
    <SetVariable id="11" style="set-variable">
      <Variable list="false" local="false" variableName="G™" />
      <BinaryOp op="*" style="op-mul">
        <Constant text="6.67" />
        <BinaryOp op="^" style="op-exp">
          <Constant text="10" />
          <Constant text="-11" />
        </BinaryOp>
      </BinaryOp>
    </SetVariable>
    <SetVariable id="12" style="set-variable">
      <Variable list="false" local="false" variableName="e™" />
      <Constant text="2.718281828459045" />
    </SetVariable>
  </Instructions>
  <Instructions>
    <Event event="FlightStart" id="13" style="flight-start" pos="-464.2318,-47.90071" />
    <SetVariable id="14" style="set-variable">
      <Variable list="false" local="false" variableName="~ON" />
      <Constant style="true" bool="true" />
    </SetVariable>
    <BroadcastMessage global="false" local="true" id="15" style="broadcast-msg">
      <Constant text="I/O" />
      <Constant text="" />
    </BroadcastMessage>
    <WaitUntil id="16" style="wait-until">
      <Variable list="false" local="false" variableName="~AUTO" />
    </WaitUntil>
    <SetVariable id="17" style="set-variable">
      <Variable list="false" local="false" variableName="~PHASE" />
      <Constant text="Ready 4 Liftoff" />
    </SetVariable>
    <If id="18" style="if">
      <Variable list="false" local="false" variableName="~ASK_INPUT" />
      <Instructions>
        <CallCustomInstruction call="ask_orbit" id="19" style="call-custom-instruction" />
      </Instructions>
    </If>
    <WaitUntil id="20" style="wait-until">
      <Comparison op="g" style="op-gt">
        <CraftProperty property="Input.Throttle" style="prop-input" />
        <Constant text="0.5" />
      </Comparison>
    </WaitUntil>
    <CallCustomInstruction call="countdown" id="21" style="call-custom-instruction" />
    <CallCustomInstruction call="liftoff" id="22" style="call-custom-instruction" />
    <CallCustomInstruction call="flight" id="23" style="call-custom-instruction" />
  </Instructions>
  <Instructions>
    <CustomInstruction callFormat="countdown" format="countdown" name="countdown" id="24" style="custom-instruction" pos="-464.4321,-592.7342" />
    <If id="25" style="if">
      <CraftProperty property="Misc.Grounded" style="prop-misc" />
      <Instructions>
        <WaitSeconds id="26" style="wait-seconds">
          <Constant text="0.5" />
        </WaitSeconds>
        <For var="i" id="27" style="for">
          <Constant text="3" />
          <Constant text="1" />
          <Constant text="-1" />
          <Instructions>
            <DisplayMessage id="28" style="display">
              <StringOp op="join" style="join">
                <Constant text="Countdown -" />
                <Variable list="false" local="true" variableName="i" />
                <Constant text="s" />
                <Constant text="" />
              </StringOp>
              <Constant number="7" />
            </DisplayMessage>
            <CallCustomInstruction call="beep" id="29" style="call-custom-instruction">
              <Constant text="1" />
              <Constant text="1000" />
              <Constant text="" />
              <Constant text="" />
            </CallCustomInstruction>
            <WaitSeconds id="30" style="wait-seconds">
              <Constant number="1" />
            </WaitSeconds>
          </Instructions>
        </For>
      </Instructions>
    </If>
  </Instructions>
  <Instructions>
    <CustomInstruction callFormat="autopilot to (0) " format="autopilot to |boolean| " name="autopilot" id="31" style="custom-instruction" pos="-463.4615,-2993.186" />
    <SetVariable id="32" style="set-variable">
      <Variable list="false" local="false" variableName="~ON" />
      <Variable list="false" local="true" variableName="boolean" />
    </SetVariable>
    <SetInput input="slider1" id="33" style="set-input">
      <Conditional style="conditional">
        <Variable list="false" local="true" variableName="boolean" />
        <Constant text="1" />
        <Constant text="0" />
      </Conditional>
    </SetInput>
    <SetVariable id="34" style="set-variable">
      <Variable list="false" local="false" variableName="~PHASE" />
      <Conditional style="conditional">
        <Variable list="false" local="true" variableName="boolean" />
        <Conditional style="conditional">
          <Variable list="false" local="false" variableName="~PHASE" />
          <Variable list="false" local="false" variableName="~PHASE" />
          <Constant text="ON" />
        </Conditional>
        <Constant text="" />
      </Conditional>
    </SetVariable>
  </Instructions>
  <Instructions>
    <Event event="ReceiveMessage" id="35" style="receive-msg" pos="-464.7214,-2479.172">
      <Constant canReplace="false" text="I/O" />
    </Event>
    <While id="36" style="while">
      <Variable list="false" local="false" variableName="~ON" />
      <Instructions>
        <WaitUntil id="37" style="wait-until">
          <Not style="op-not">
            <Comparison op="=" style="op-eq">
              <Variable list="false" local="false" variableName="~io" />
              <CraftProperty property="Input.Slider1" style="prop-input" />
            </Comparison>
          </Not>
        </WaitUntil>
        <SetVariable id="38" style="set-variable">
          <Variable list="false" local="false" variableName="~io" />
          <CraftProperty property="Input.Slider1" style="prop-input" />
        </SetVariable>
        <Comment id="39" style="comment">
          <Constant style="comment-text" canReplace="false" text="Autopilot ON/OFF" />
        </Comment>
        <SetVariable id="40" style="set-variable">
          <Variable list="false" local="false" variableName="~ON" />
          <Comparison op="l" style="op-lt">
            <Constant text="-0.7" />
            <Variable list="false" local="false" variableName="~io" />
          </Comparison>
        </SetVariable>
        <Comment id="41" style="comment">
          <Constant style="comment-text" canReplace="false" text="Auto/Manual" />
        </Comment>
        <SetVariable id="42" style="set-variable">
          <Variable list="false" local="false" variableName="~AUTO" />
          <Comparison op="l" style="op-lt">
            <Constant text="+0.2" />
            <Variable list="false" local="false" variableName="~io" />
          </Comparison>
        </SetVariable>
        <Comment id="43" style="comment">
          <Constant style="comment-text" canReplace="false" text="Ask for input for autopilot" />
        </Comment>
        <SetVariable id="44" style="set-variable">
          <Variable list="false" local="false" variableName="~ASK_INPUT" />
          <BoolOp op="and" style="op-and">
            <Comparison op="le" style="op-lte">
              <Constant text="+0.2" />
              <Variable list="false" local="false" variableName="~io" />
            </Comparison>
            <Comparison op="l" style="op-lt">
              <Variable list="false" local="false" variableName="~io" />
              <Constant text="+0.7" />
            </Comparison>
          </BoolOp>
        </SetVariable>
      </Instructions>
    </While>
  </Instructions>
  <Instructions>
    <CustomInstruction callFormat="log (0) " format="log |something| " name="log" id="45" style="custom-instruction" pos="2768.315,-21.23423" />
    <LogMessage id="46" style="log">
      <StringOp op="join" style="join">
        <Constant text="Δv_circ=" />
        <StringOp op="friendly" subOp="velocity" style="friendly">
          <CallCustomExpression call="∆v_circ" style="call-custom-expression">
            <Constant number="0" />
          </CallCustomExpression>
        </StringOp>
        <Constant text="///burnt=" />
        <CallCustomExpression call="circ_burntime" style="call-custom-expression" />
        <Constant text="///" />
        <Constant text="1-thr" />
        <BinaryOp op="^" style="op-exp">
          <BinaryOp op="/" style="op-div">
            <CallCustomExpression call="Pe" style="call-custom-expression" />
            <BinaryOp op="*" style="op-mul">
              <Variable list="false" local="false" variableName="`Pe" />
              <Constant text="1.1" />
            </BinaryOp>
          </BinaryOp>
          <Constant text="3" />
        </BinaryOp>
        <Constant text="//circnow=" />
        <CallCustomExpression call="circ_now" style="call-custom-expression" />
        <Constant text="" />
      </StringOp>
    </LogMessage>
  </Instructions>
  <Instructions>
    <LogMessage id="47" style="log" pos="2761.583,-203.2151">
      <StringOp op="join" style="join">
        <Constant text="/°=" />
        <StringOp op="format" style="format">
          <Constant text="{0:n2}" />
          <BinaryOp op="/" style="op-div">
            <CraftProperty property="Altitude.ASL" style="prop-altitude" />
            <Planet op="atmosphereHeight" style="planet">
              <Constant text="Droo" />
            </Planet>
          </BinaryOp>
          <Constant text="" />
        </StringOp>
        <Constant text="///" />
        <StringOp op="format" style="format">
          <Constant text="{0:n2}" />
          <BinaryOp op="^" style="op-exp">
            <BinaryOp op="/" style="op-div">
              <CraftProperty property="Altitude.ASL" style="prop-altitude" />
              <Planet op="atmosphereHeight" style="planet">
                <Constant text="Droo" />
              </Planet>
            </BinaryOp>
            <Variable list="false" local="false" variableName="`ascent_angle_k" />
          </BinaryOp>
          <Constant text="" />
        </StringOp>
        <Constant text="///" />
        <StringOp op="format" style="format">
          <Constant text="{0:n2}" />
          <MathFunction function="deg2rad" style="op-math">
            <CallCustomExpression call="ascent angle" style="call-custom-expression" />
          </MathFunction>
          <Constant text="" />
        </StringOp>
        <Constant text="///" />
        <StringOp op="format" style="format">
          <Constant text="{0:n1}" />
          <CallCustomExpression call="ascent angle" style="call-custom-expression" />
          <Constant text="°" />
          <Constant text="" />
        </StringOp>
        <Constant text="" />
      </StringOp>
    </LogMessage>
    <LogMessage id="48" style="log">
      <StringOp op="join" style="join">
        <Constant text="Eng thrust =" />
        <StringOp op="friendly" subOp="force" style="friendly">
          <CraftProperty property="Performance.CurrentEngineThrust" style="prop-performance" />
        </StringOp>
        <Constant text="" />
      </StringOp>
    </LogMessage>
    <LogMessage id="49" style="log">
      <StringOp op="join" style="join">
        <Constant text="Max eng thrust =" />
        <StringOp op="friendly" subOp="force" style="friendly">
          <CraftProperty property="Performance.MaxActiveEngineThrust" style="prop-performance" />
        </StringOp>
        <Constant text="" />
      </StringOp>
    </LogMessage>
    <LogMessage id="50" style="log">
      <StringOp op="join" style="join">
        <Constant text="Totmass=" />
        <StringOp op="friendly" subOp="mass" style="friendly">
          <CraftProperty property="Performance.Mass" style="prop-performance" />
        </StringOp>
        <Constant text="///EMass=" />
        <StringOp op="friendly" subOp="distance" style="friendly">
          <CraftProperty property="Performance.DryMass" style="prop-performance" />
        </StringOp>
        <Constant text="///FMass=" />
        <StringOp op="friendly" subOp="distance" style="friendly">
          <CraftProperty property="Performance.FuelMass" style="prop-performance" />
        </StringOp>
        <Constant text="" />
      </StringOp>
    </LogMessage>
    <LogMessage id="51" style="log">
      <StringOp op="join" style="join">
        <Constant text="Pe=" />
        <StringOp op="friendly" subOp="distance" style="friendly">
          <CraftProperty property="Orbit.Periapsis" style="prop-orbit" />
        </StringOp>
        <Constant text="///Pe=" />
        <StringOp op="friendly" subOp="distance" style="friendly">
          <CallCustomExpression call="Pe" style="call-custom-expression" />
        </StringOp>
        <Constant text="" />
      </StringOp>
    </LogMessage>
    <LogMessage id="52" style="log">
      <StringOp op="join" style="join">
        <Constant text="///" />
        <CraftProperty property="Fuel.FuelInStage" style="prop-fuel" />
        <Constant text="///" />
        <CraftProperty property="Misc.Stage" style="prop-misc" />
        <Constant text="///" />
        <CraftProperty property="Misc.NumStages" style="prop-misc" />
        <Constant text="///" />
        <Constant text="" />
      </StringOp>
    </LogMessage>
  </Instructions>
  <Instructions>
    <CustomInstruction callFormat="ask_orbit" format="ask_orbit" name="ask_orbit" id="53" style="custom-instruction" pos="718.8292,-50.82972" />
    <UserInput id="54" style="user-input">
      <Variable list="false" local="false" variableName="``orbit_params" />
      <Constant text="Set Ap, Pe, incl" />
    </UserInput>
    <SetVariable id="55" style="list-init">
      <Variable list="true" local="false" variableName="`ApPe" />
      <ListOp op="create" style="list-create">
        <Variable list="false" local="false" variableName="``orbit_params" />
      </ListOp>
    </SetVariable>
    <SetVariable id="56" style="set-variable">
      <Variable list="false" local="false" variableName="`Ap" />
      <Conditional style="conditional">
        <ListOp op="get" style="list-get">
          <Variable list="true" local="false" variableName="`ApPe" />
          <Constant number="1" />
        </ListOp>
        <BinaryOp op="*" style="op-mul">
          <ListOp op="get" style="list-get">
            <Variable list="true" local="false" variableName="`ApPe" />
            <Constant number="1" />
          </ListOp>
          <Constant text="1000" />
        </BinaryOp>
        <Variable list="false" local="false" variableName="`Ap" />
      </Conditional>
    </SetVariable>
    <SetVariable id="57" style="set-variable">
      <Variable list="false" local="false" variableName="`Pe" />
      <Conditional style="conditional">
        <ListOp op="get" style="list-get">
          <Variable list="true" local="false" variableName="`ApPe" />
          <Constant text="2" />
        </ListOp>
        <BinaryOp op="*" style="op-mul">
          <ListOp op="get" style="list-get">
            <Variable list="true" local="false" variableName="`ApPe" />
            <Constant text="2" />
          </ListOp>
          <Constant text="1000" />
        </BinaryOp>
        <Variable list="false" local="false" variableName="`Ap" />
      </Conditional>
    </SetVariable>
    <SetVariable id="58" style="set-variable">
      <Variable list="false" local="false" variableName="`inclination" />
      <Conditional style="conditional">
        <ListOp op="get" style="list-get">
          <Variable list="true" local="false" variableName="`ApPe" />
          <Constant text="3" />
        </ListOp>
        <ListOp op="get" style="list-get">
          <Variable list="true" local="false" variableName="`ApPe" />
          <Constant text="3" />
        </ListOp>
        <Variable list="false" local="false" variableName="`inclination" />
      </Conditional>
    </SetVariable>
    <DisplayMessage id="59" style="display">
      <StringOp op="join" style="join">
        <Constant text="Set: Ap=" />
        <StringOp op="friendly" subOp="distance" style="friendly">
          <Variable list="false" local="false" variableName="`Ap" />
        </StringOp>
        <Constant text="__Pe=" />
        <StringOp op="friendly" subOp="distance" style="friendly">
          <Variable list="false" local="false" variableName="`Pe" />
        </StringOp>
        <Constant text="__incl=" />
        <Variable list="false" local="false" variableName="`inclination" />
        <Constant text="°" />
        <Constant text="" />
      </StringOp>
      <Constant number="7" />
    </DisplayMessage>
  </Instructions>
  <Instructions>
    <Event event="ReceiveMessage" id="60" style="receive-msg" pos="718.5868,-592.9222">
      <Constant canReplace="false" text="staging" />
    </Event>
    <While id="61" style="while">
      <Variable list="false" local="false" variableName="~ON" />
      <Instructions>
        <While id="62" style="while">
          <Variable list="false" local="false" variableName="~AUTO" />
          <Instructions>
            <WaitUntil id="63" style="wait-until">
              <Comparison op="le" style="op-lte">
                <CraftProperty property="Fuel.FuelInStage" style="prop-fuel" />
                <Constant number="-0" />
              </Comparison>
            </WaitUntil>
            <WaitSeconds id="64" style="wait-seconds">
              <Constant text="0.7" />
            </WaitSeconds>
            <ActivateStage id="65" style="activate-stage" />
            <If id="66" style="if">
              <Comparison op="g" style="op-gt">
                <CraftProperty property="Fuel.FuelInStage" style="prop-fuel" />
                <Constant number="0" />
              </Comparison>
              <Instructions>
                <CallCustomInstruction call="stage_fuel_percent_mass_calc" id="67" style="call-custom-instruction">
                  <CraftProperty property="Performance.FuelMass" style="prop-performance" />
                  <CraftProperty property="Fuel.FuelInStage" style="prop-fuel" />
                </CallCustomInstruction>
              </Instructions>
            </If>
            <ElseIf id="68" style="else">
              <Constant bool="true" />
              <Instructions>
                <SetVariable id="69" style="set-variable">
                  <Variable list="false" local="false" variableName="stage_fuel_percent_mass" />
                  <Constant text="0" />
                </SetVariable>
              </Instructions>
            </ElseIf>
            <WaitSeconds id="70" style="wait-seconds">
              <Constant text="0.5" />
            </WaitSeconds>
          </Instructions>
        </While>
      </Instructions>
    </While>
  </Instructions>
  <Instructions>
    <CustomInstruction callFormat="ascent" format="ascent" name="ascent" id="71" style="custom-instruction" pos="717.4824,-1293.187" />
    <While id="72" style="while">
      <BoolOp op="and" style="op-and">
        <Variable list="false" local="false" variableName="~ON" />
        <Comparison op="l" style="op-lt">
          <CraftProperty property="Orbit.Apoapsis" style="prop-orbit" />
          <Variable list="false" local="false" variableName="`Ap" />
        </Comparison>
      </BoolOp>
      <Instructions>
        <SetVariable id="73" style="set-variable">
          <Variable list="false" local="false" variableName="Q" />
          <BinaryOp op="max" style="op-max">
            <Constant text="0.1" />
            <BinaryOp op="/" style="op-div">
              <BinaryOp op="*" style="op-mul">
                <CraftProperty property="Atmosphere.AirDensity" style="prop-atmosphere" />
                <BinaryOp op="^" style="op-exp">
                  <VectorOp op="length" style="vec-op-1">
                    <CraftProperty property="Vel.SurfaceVelocity" style="prop-velocity" />
                  </VectorOp>
                  <Constant text="2" />
                </BinaryOp>
              </BinaryOp>
              <Constant text="2" />
            </BinaryOp>
          </BinaryOp>
        </SetVariable>
        <If id="74" style="if">
          <Variable list="false" local="false" variableName="~AUTO" />
          <Instructions>
            <SetTargetHeading property="heading" id="75" style="set-heading">
              <BinaryOp op="-" style="op-sub">
                <Constant text="90" />
                <Variable list="false" local="false" variableName="`inclination" />
              </BinaryOp>
            </SetTargetHeading>
            <SetTargetHeading property="pitch" id="76" style="set-heading">
              <CallCustomExpression call="ascent angle" style="call-custom-expression" />
            </SetTargetHeading>
            <SetInput input="throttle" id="77" style="set-input">
              <CallCustomExpression call="ascent thrust" style="call-custom-expression" />
            </SetInput>
          </Instructions>
        </If>
      </Instructions>
    </While>
    <If id="78" style="if">
      <Variable list="false" local="false" variableName="~AUTO" />
      <Instructions>
        <SetInput input="throttle" id="79" style="set-input">
          <Constant text="0" />
        </SetInput>
        <LockNavSphere indicatorType="Prograde" id="80" style="lock-nav-sphere" />
        <CallCustomInstruction call="beep" id="81" style="call-custom-instruction">
          <Constant text="2" />
          <Constant text="700" />
          <Constant text="0.07" />
          <Constant text="0.1" />
        </CallCustomInstruction>
        <WaitSeconds id="82" style="wait-seconds">
          <Constant number="1" />
        </WaitSeconds>
      </Instructions>
    </If>
  </Instructions>
  <Instructions>
    <CustomInstruction callFormat="circularize" format="circularize" name="circularize" id="83" style="custom-instruction" pos="717.0978,-2065.224" />
    <While id="84" style="while">
      <BoolOp op="and" style="op-and">
        <Variable list="false" local="false" variableName="~ON" />
        <Comparison op="l" style="op-lt">
          <CallCustomExpression call="Pe" style="call-custom-expression" />
          <Variable list="false" local="false" variableName="`Pe" />
        </Comparison>
      </BoolOp>
      <Instructions>
        <If id="85" style="if">
          <Not style="op-not">
            <CallCustomExpression call="circ_now" style="call-custom-expression" />
          </Not>
          <Instructions>
            <SetInput input="throttle" id="86" style="set-input">
              <Conditional style="conditional">
                <Variable list="false" local="false" variableName="~AUTO" />
                <Constant text="0" />
                <CraftProperty property="Input.Throttle" style="prop-input" />
              </Conditional>
            </SetInput>
            <SetVariable id="87" style="set-variable">
              <Variable list="false" local="false" variableName="~PHASE" />
              <Conditional style="conditional">
                <Variable list="false" local="false" variableName="~ON" />
                <Constant text="Wait Circ" />
                <Constant text="" />
              </Conditional>
            </SetVariable>
            <SetTimeMode mode="TimeWarp1" id="88" style="set-time-mode" />
            <WaitUntil id="89" style="wait-until">
              <BoolOp op="or" style="op-or">
                <Not style="op-not">
                  <Variable list="false" local="false" variableName="~ON" />
                </Not>
                <CallCustomExpression call="circ_now" style="call-custom-expression" />
              </BoolOp>
            </WaitUntil>
            <SetTimeMode mode="Normal" id="90" style="set-time-mode" />
            <If id="91" style="if">
              <Not style="op-not">
                <Variable list="false" local="false" variableName="circ_∆V" />
              </Not>
              <Instructions>
                <SetVariable id="92" style="set-variable">
                  <Variable list="false" local="false" variableName="circ_∆V" />
                  <CallCustomExpression call="∆v_circ" style="call-custom-expression">
                    <Constant number="0" />
                  </CallCustomExpression>
                </SetVariable>
              </Instructions>
            </If>
            <CallCustomInstruction call="beep" id="93" style="call-custom-instruction">
              <Constant text="2" />
              <Constant text="700" />
              <Constant text="0.07" />
              <Constant text="0.1" />
            </CallCustomInstruction>
          </Instructions>
        </If>
        <SetVariable id="94" style="set-variable">
          <Variable list="false" local="false" variableName="~PHASE" />
          <Conditional style="conditional">
            <Variable list="false" local="false" variableName="~ON" />
            <Constant text="Circularization" />
            <Constant text="" />
          </Conditional>
        </SetVariable>
        <If id="95" style="if">
          <Variable list="false" local="false" variableName="~AUTO" />
          <Instructions>
            <SetTargetHeading property="pitch" id="96" style="set-heading">
              <Constant number="0" />
            </SetTargetHeading>
            <SetInput input="throttle" id="97" style="set-input">
              <BinaryOp op="-" style="op-sub">
                <Constant text="1" />
                <BinaryOp op="^" style="op-exp">
                  <BinaryOp op="/" style="op-div">
                    <BinaryOp op="max" style="op-max">
                      <Constant number="0" />
                      <CallCustomExpression call="Pe" style="call-custom-expression" />
                    </BinaryOp>
                    <BinaryOp op="*" style="op-mul">
                      <Variable list="false" local="false" variableName="`Pe" />
                      <Constant text="1.1" />
                    </BinaryOp>
                  </BinaryOp>
                  <Constant text="3" />
                </BinaryOp>
              </BinaryOp>
            </SetInput>
          </Instructions>
        </If>
      </Instructions>
    </While>
    <If id="98" style="if">
      <Variable list="false" local="false" variableName="~AUTO" />
      <Instructions>
        <SetInput input="throttle" id="99" style="set-input">
          <Constant number="-0" />
        </SetInput>
        <LockNavSphere indicatorType="None" id="100" style="lock-nav-sphere" />
      </Instructions>
    </If>
  </Instructions>
  <Instructions>
    <Comment id="101" style="comment" pos="3220.955,-1960.468">
      <Constant style="comment-text" canReplace="false" text="legacy - set ascent thrust" />
    </Comment>
    <If id="102" style="if">
      <BoolOp op="or" style="op-or">
        <Comparison op="ge" style="op-gte">
          <Variable list="false" local="false" variableName="Q" />
          <Variable list="false" local="false" variableName="`max_maxQ" />
        </Comparison>
        <Comparison op="g" style="op-gt">
          <CraftProperty property="Performance.TWR" style="prop-performance" />
          <Variable list="false" local="false" variableName="`max_TWR" />
        </Comparison>
      </BoolOp>
      <Instructions>
        <SetInput input="throttle" id="103" style="set-input">
          <BinaryOp op="-" style="op-sub">
            <CraftProperty property="Input.Throttle" style="prop-input" />
            <Constant text="0.01" />
          </BinaryOp>
        </SetInput>
        <WaitSeconds id="104" style="wait-seconds">
          <Constant text="0.15" />
        </WaitSeconds>
      </Instructions>
    </If>
    <ElseIf id="105" style="else">
      <Constant bool="true" />
      <Instructions>
        <SetInput input="throttle" id="106" style="set-input">
          <BinaryOp op="min" style="op-min">
            <Constant text="1" />
            <BinaryOp op="+" style="op-add">
              <CraftProperty property="Input.Throttle" style="prop-input" />
              <Constant text="0.01" />
            </BinaryOp>
          </BinaryOp>
        </SetInput>
        <WaitSeconds id="107" style="wait-seconds">
          <Constant text="0.15" />
        </WaitSeconds>
      </Instructions>
    </ElseIf>
  </Instructions>
  <Instructions>
    <CustomInstruction callFormat="stage_fuel_percent_mass_calc (0) (1) " format="stage_fuel_percent_mass_calc |fuel_mass_0| |fuel_percent_0| " name="stage_fuel_percent_mass_calc" id="108" style="custom-instruction" pos="2001.072,-882.1194" />
    <WaitSeconds id="109" style="wait-seconds">
      <Constant number="1" />
    </WaitSeconds>
    <SetVariable id="110" style="set-variable">
      <Variable list="false" local="false" variableName="stage_fuel_percent_mass" />
      <BinaryOp op="/" style="op-div">
        <BinaryOp op="-" style="op-sub">
          <Variable list="false" local="true" variableName="fuel_mass_0" />
          <CraftProperty property="Performance.FuelMass" style="prop-performance" />
        </BinaryOp>
        <BinaryOp op="-" style="op-sub">
          <Variable list="false" local="true" variableName="fuel_percent_0" />
          <CraftProperty property="Fuel.FuelInStage" style="prop-fuel" />
        </BinaryOp>
      </BinaryOp>
    </SetVariable>
  </Instructions>
  <Instructions>
    <Event event="ReceiveMessage" id="111" style="receive-msg" pos="4467.87,-3544.771">
      <Constant canReplace="false" text="display" />
    </Event>
    <While id="112" style="while">
      <Variable list="false" local="false" variableName="~ON" />
      <Instructions>
        <If id="113" style="if">
          <StringOp op="contains" style="contains">
            <Variable list="false" local="false" variableName="~PHASE" />
            <Constant text="Ascent" />
          </StringOp>
          <Instructions>
            <SetVariable id="114" style="set-variable">
              <Variable list="false" local="false" variableName="display" />
              <Constant text="Ascent -" />
            </SetVariable>
            <SetVariable id="115" style="set-variable">
              <Variable list="false" local="false" variableName="display" />
              <StringOp op="join" style="join">
                <Variable list="false" local="false" variableName="display" />
                <Constant text="-" />
                <StringOp op="join" style="join">
                  <Constant text="{Ap=" />
                  <StringOp op="friendly" subOp="distance" style="friendly">
                    <CallCustomExpression call="Ap" style="call-custom-expression" />
                  </StringOp>
                  <Constant text="}" />
                  <Constant text="" />
                </StringOp>
                <Constant text="" />
              </StringOp>
            </SetVariable>
            <SetVariable id="116" style="set-variable">
              <Variable list="false" local="false" variableName="display" />
              <StringOp op="join" style="join">
                <Variable list="false" local="false" variableName="display" />
                <Constant text="-" />
                <StringOp op="join" style="join">
                  <Constant text="{ttAp=" />
                  <StringOp op="friendly" subOp="time" style="friendly">
                    <CraftProperty property="Orbit.TimeToApoapsis" style="prop-orbit" />
                  </StringOp>
                  <Constant text="}" />
                  <Constant text="" />
                </StringOp>
                <Constant text="" />
              </StringOp>
            </SetVariable>
            <SetVariable id="117" style="set-variable">
              <Variable list="false" local="false" variableName="display" />
              <StringOp op="join" style="join">
                <Variable list="false" local="false" variableName="display" />
                <Constant text="-" />
                <StringOp op="join" style="join">
                  <Constant text="{e=" />
                  <BinaryOp op="/" style="op-div">
                    <MathFunction function="round" style="op-math">
                      <BinaryOp op="*" style="op-mul">
                        <CraftProperty property="Orbit.Eccentricity" style="prop-orbit" />
                        <Constant text="100" />
                      </BinaryOp>
                    </MathFunction>
                    <Constant text="100" />
                  </BinaryOp>
                  <Constant text="}" />
                  <Constant text="" />
                </StringOp>
                <Constant text="" />
              </StringOp>
            </SetVariable>
            <SetVariable id="118" style="set-variable">
              <Variable list="false" local="false" variableName="display" />
              <StringOp op="join" style="join">
                <Variable list="false" local="false" variableName="display" />
                <Constant text="-" />
                <StringOp op="join" style="join">
                  <Constant text="{a°=" />
                  <StringOp op="format" style="format">
                    <Constant text="{0:n1}" />
                    <CraftProperty property="Nav.Pitch" style="prop-nav" />
                    <Constant text="" />
                  </StringOp>
                  <Constant text="}" />
                  <Constant text="" />
                </StringOp>
                <Constant text="" />
              </StringOp>
            </SetVariable>
            <SetVariable id="119" style="set-variable">
              <Variable list="false" local="false" variableName="display" />
              <StringOp op="join" style="join">
                <Variable list="false" local="false" variableName="display" />
                <Constant text="-" />
                <StringOp op="join" style="join">
                  <Constant text="{aoa°=" />
                  <StringOp op="format" style="format">
                    <Constant text="{0:n1}" />
                    <CraftProperty property="Nav.AngleOfAttack" style="prop-nav" />
                    <Constant text="" />
                  </StringOp>
                  <Constant text="}" />
                  <Constant text="" />
                </StringOp>
                <Constant text="" />
              </StringOp>
            </SetVariable>
            <SetVariable id="120" style="set-variable">
              <Variable list="false" local="false" variableName="display" />
              <StringOp op="join" style="join">
                <Variable list="false" local="false" variableName="display" />
                <Constant text="-" />
                <StringOp op="join" style="join">
                  <Constant text="{TWR=" />
                  <StringOp op="format" style="format">
                    <Constant text="{0:n1}" />
                    <CraftProperty property="Performance.TWR" style="prop-performance" />
                    <Constant text="" />
                  </StringOp>
                  <Constant text="}" />
                  <Constant text="" />
                </StringOp>
                <Constant text="" />
              </StringOp>
            </SetVariable>
            <SetVariable id="121" style="set-variable">
              <Variable list="false" local="false" variableName="display" />
              <Conditional style="conditional">
                <Comparison op="g" style="op-gt">
                  <Variable list="false" local="false" variableName="Q" />
                  <Constant text="2000" />
                </Comparison>
                <StringOp op="join" style="join">
                  <Variable list="false" local="false" variableName="display" />
                  <Constant text="-" />
                  <StringOp op="join" style="join">
                    <Constant text="{Q=" />
                    <StringOp op="format" style="format">
                      <Constant text="{0:n1}" />
                      <BinaryOp op="/" style="op-div">
                        <Variable list="false" local="false" variableName="Q" />
                        <Constant text="1000" />
                      </BinaryOp>
                      <Constant text="" />
                    </StringOp>
                    <Constant text="k}" />
                    <Constant text="" />
                  </StringOp>
                  <Constant text="" />
                </StringOp>
                <Variable list="false" local="false" variableName="display" />
              </Conditional>
            </SetVariable>
            <DisplayMessage id="122" style="display">
              <Variable list="false" local="false" variableName="display" />
              <Constant number="7" />
            </DisplayMessage>
          </Instructions>
        </If>
        <ElseIf id="123" style="else-if">
          <StringOp op="contains" style="contains">
            <Variable list="false" local="false" variableName="~PHASE" />
            <Constant text="Wait Circ" />
          </StringOp>
          <Instructions>
            <SetVariable id="124" style="set-variable">
              <Variable list="false" local="false" variableName="display" />
              <Constant text="Awaiting circ -" />
            </SetVariable>
            <SetVariable id="125" style="set-variable">
              <Variable list="false" local="false" variableName="display" />
              <StringOp op="join" style="join">
                <Variable list="false" local="false" variableName="display" />
                <Constant text="-" />
                <StringOp op="join" style="join">
                  <Constant text="{Ap=" />
                  <StringOp op="friendly" subOp="distance" style="friendly">
                    <CallCustomExpression call="Ap" style="call-custom-expression" />
                  </StringOp>
                  <Constant text="}" />
                  <Constant text="" />
                </StringOp>
                <Constant text="" />
              </StringOp>
            </SetVariable>
            <SetVariable id="126" style="set-variable">
              <Variable list="false" local="false" variableName="display" />
              <StringOp op="join" style="join">
                <Variable list="false" local="false" variableName="display" />
                <Constant text="-" />
                <StringOp op="join" style="join">
                  <Constant text="{Pe=" />
                  <StringOp op="friendly" subOp="distance" style="friendly">
                    <CallCustomExpression call="Pe" style="call-custom-expression" />
                  </StringOp>
                  <Constant text="}" />
                  <Constant text="" />
                </StringOp>
                <Constant text="" />
              </StringOp>
            </SetVariable>
            <SetVariable id="127" style="set-variable">
              <Variable list="false" local="false" variableName="display" />
              <StringOp op="join" style="join">
                <Variable list="false" local="false" variableName="display" />
                <Constant text="-" />
                <StringOp op="join" style="join">
                  <Constant text="{e=" />
                  <BinaryOp op="/" style="op-div">
                    <MathFunction function="round" style="op-math">
                      <BinaryOp op="*" style="op-mul">
                        <CraftProperty property="Orbit.Eccentricity" style="prop-orbit" />
                        <Constant text="100" />
                      </BinaryOp>
                    </MathFunction>
                    <Constant text="100" />
                  </BinaryOp>
                  <Constant text="}" />
                  <Constant text="" />
                </StringOp>
                <Constant text="" />
              </StringOp>
            </SetVariable>
            <SetVariable id="128" style="set-variable">
              <Variable list="false" local="false" variableName="display" />
              <StringOp op="join" style="join">
                <Variable list="false" local="false" variableName="display" />
                <Constant text="-" />
                <StringOp op="join" style="join">
                  <Constant text="{ttAp=" />
                  <StringOp op="friendly" subOp="time" style="friendly">
                    <CraftProperty property="Orbit.TimeToApoapsis" style="prop-orbit" />
                  </StringOp>
                  <Constant text="}" />
                  <Constant text="" />
                </StringOp>
                <Constant text="" />
              </StringOp>
            </SetVariable>
            <SetVariable id="129" style="set-variable">
              <Variable list="false" local="false" variableName="display" />
              <StringOp op="join" style="join">
                <Variable list="false" local="false" variableName="display" />
                <Constant text="-" />
                <StringOp op="join" style="join">
                  <Constant text="{ttBurn=" />
                  <StringOp op="friendly" subOp="time" style="friendly">
                    <BinaryOp op="-" style="op-sub">
                      <CraftProperty property="Orbit.TimeToApoapsis" style="prop-orbit" />
                      <BinaryOp op="*" style="op-mul">
                        <Constant text="0.5" />
                        <CallCustomExpression call="circ_burntime" style="call-custom-expression" />
                      </BinaryOp>
                    </BinaryOp>
                  </StringOp>
                  <Constant text="}" />
                  <Constant text="" />
                </StringOp>
                <Constant text="" />
              </StringOp>
            </SetVariable>
            <SetVariable id="130" style="set-variable">
              <Variable list="false" local="false" variableName="display" />
              <StringOp op="join" style="join">
                <Variable list="false" local="false" variableName="display" />
                <Constant text="-" />
                <StringOp op="join" style="join">
                  <Constant text="{burntime=" />
                  <StringOp op="friendly" subOp="time" style="friendly">
                    <CallCustomExpression call="circ_burntime" style="call-custom-expression" />
                  </StringOp>
                  <Constant text="}" />
                  <Constant text="" />
                </StringOp>
                <Constant text="" />
              </StringOp>
            </SetVariable>
            <SetVariable id="131" style="set-variable">
              <Variable list="false" local="false" variableName="display" />
              <StringOp op="join" style="join">
                <Variable list="false" local="false" variableName="display" />
                <Constant text="-" />
                <StringOp op="join" style="join">
                  <Constant text="{∆V=" />
                  <StringOp op="format" style="format">
                    <Constant text="{0:n1}" />
                    <CallCustomExpression call="∆v_circ" style="call-custom-expression">
                      <Constant number="0" />
                    </CallCustomExpression>
                    <Constant text="" />
                  </StringOp>
                  <Constant text="/" />
                  <StringOp op="friendly" subOp="velocity" style="friendly">
                    <Conditional style="conditional">
                      <Variable list="false" local="false" variableName="circ_∆V" />
                      <Variable list="false" local="false" variableName="circ_∆V" />
                      <CallCustomExpression call="∆v_circ" style="call-custom-expression">
                        <Constant number="0" />
                      </CallCustomExpression>
                    </Conditional>
                  </StringOp>
                  <Constant text="}" />
                  <Constant text="" />
                </StringOp>
                <Constant text="" />
              </StringOp>
            </SetVariable>
            <DisplayMessage id="132" style="display">
              <Variable list="false" local="false" variableName="display" />
              <Constant number="7" />
            </DisplayMessage>
          </Instructions>
        </ElseIf>
        <ElseIf id="133" style="else-if">
          <StringOp op="contains" style="contains">
            <Variable list="false" local="false" variableName="~PHASE" />
            <Constant text="Circularization" />
          </StringOp>
          <Instructions>
            <SetVariable id="134" style="set-variable">
              <Variable list="false" local="false" variableName="display" />
              <Constant text="Circularization -" />
            </SetVariable>
            <SetVariable id="135" style="set-variable">
              <Variable list="false" local="false" variableName="display" />
              <StringOp op="join" style="join">
                <Variable list="false" local="false" variableName="display" />
                <Constant text="-" />
                <StringOp op="join" style="join">
                  <Constant text="{Ap=" />
                  <StringOp op="friendly" subOp="distance" style="friendly">
                    <CallCustomExpression call="Ap" style="call-custom-expression" />
                  </StringOp>
                  <Constant text="}" />
                  <Constant text="" />
                </StringOp>
                <Constant text="" />
              </StringOp>
            </SetVariable>
            <SetVariable id="136" style="set-variable">
              <Variable list="false" local="false" variableName="display" />
              <StringOp op="join" style="join">
                <Variable list="false" local="false" variableName="display" />
                <Constant text="-" />
                <StringOp op="join" style="join">
                  <Constant text="{Pe=" />
                  <StringOp op="friendly" subOp="distance" style="friendly">
                    <CallCustomExpression call="Pe" style="call-custom-expression" />
                  </StringOp>
                  <Constant text="}" />
                  <Constant text="" />
                </StringOp>
                <Constant text="" />
              </StringOp>
            </SetVariable>
            <SetVariable id="137" style="set-variable">
              <Variable list="false" local="false" variableName="display" />
              <StringOp op="join" style="join">
                <Variable list="false" local="false" variableName="display" />
                <Constant text="-" />
                <StringOp op="join" style="join">
                  <Constant text="{e=" />
                  <BinaryOp op="/" style="op-div">
                    <MathFunction function="round" style="op-math">
                      <BinaryOp op="*" style="op-mul">
                        <CraftProperty property="Orbit.Eccentricity" style="prop-orbit" />
                        <Constant text="100" />
                      </BinaryOp>
                    </MathFunction>
                    <Constant text="100" />
                  </BinaryOp>
                  <Constant text="}" />
                  <Constant text="" />
                </StringOp>
                <Constant text="" />
              </StringOp>
            </SetVariable>
            <SetVariable id="138" style="set-variable">
              <Variable list="false" local="false" variableName="display" />
              <StringOp op="join" style="join">
                <Variable list="false" local="false" variableName="display" />
                <Constant text="-" />
                <StringOp op="join" style="join">
                  <Constant text="{ttAp=" />
                  <StringOp op="friendly" subOp="time" style="friendly">
                    <CraftProperty property="Orbit.TimeToApoapsis" style="prop-orbit" />
                  </StringOp>
                  <Constant text="}" />
                  <Constant text="" />
                </StringOp>
                <Constant text="" />
              </StringOp>
            </SetVariable>
            <SetVariable id="139" style="set-variable">
              <Variable list="false" local="false" variableName="display" />
              <StringOp op="join" style="join">
                <Variable list="false" local="false" variableName="display" />
                <Constant text="-" />
                <StringOp op="join" style="join">
                  <Constant text="{ttBurn=" />
                  <StringOp op="friendly" subOp="time" style="friendly">
                    <BinaryOp op="-" style="op-sub">
                      <CraftProperty property="Orbit.TimeToApoapsis" style="prop-orbit" />
                      <BinaryOp op="*" style="op-mul">
                        <Constant text="0.5" />
                        <CallCustomExpression call="circ_burntime" style="call-custom-expression" />
                      </BinaryOp>
                    </BinaryOp>
                  </StringOp>
                  <Constant text="}" />
                  <Constant text="" />
                </StringOp>
                <Constant text="" />
              </StringOp>
            </SetVariable>
            <SetVariable id="140" style="set-variable">
              <Variable list="false" local="false" variableName="display" />
              <StringOp op="join" style="join">
                <Variable list="false" local="false" variableName="display" />
                <Constant text="-" />
                <StringOp op="join" style="join">
                  <Constant text="{burntime=" />
                  <StringOp op="friendly" subOp="time" style="friendly">
                    <CallCustomExpression call="circ_burntime" style="call-custom-expression" />
                  </StringOp>
                  <Constant text="}" />
                  <Constant text="" />
                </StringOp>
                <Constant text="" />
              </StringOp>
            </SetVariable>
            <SetVariable id="141" style="set-variable">
              <Variable list="false" local="false" variableName="display" />
              <StringOp op="join" style="join">
                <Variable list="false" local="false" variableName="display" />
                <Constant text="-" />
                <StringOp op="join" style="join">
                  <Constant text="{∆V=" />
                  <StringOp op="format" style="format">
                    <Constant text="{0:n1}" />
                    <CallCustomExpression call="∆v_circ" style="call-custom-expression">
                      <Constant number="0" />
                    </CallCustomExpression>
                    <Constant text="" />
                  </StringOp>
                  <Constant text="/" />
                  <StringOp op="friendly" subOp="velocity" style="friendly">
                    <Variable list="false" local="false" variableName="circ_∆V" />
                  </StringOp>
                  <Constant text="}" />
                  <Constant text="" />
                </StringOp>
                <Constant text="" />
              </StringOp>
            </SetVariable>
            <DisplayMessage id="142" style="display">
              <Variable list="false" local="false" variableName="display" />
              <Constant number="7" />
            </DisplayMessage>
          </Instructions>
        </ElseIf>
        <ElseIf id="143" style="else-if">
          <StringOp op="contains" style="contains">
            <Variable list="false" local="false" variableName="~PHASE" />
            <Constant text="Finished" />
          </StringOp>
          <Instructions>
            <SetVariable id="144" style="set-variable">
              <Variable list="false" local="false" variableName="display" />
              <Constant text="In space ! -" />
            </SetVariable>
            <SetVariable id="145" style="set-variable">
              <Variable list="false" local="false" variableName="display" />
              <StringOp op="join" style="join">
                <Variable list="false" local="false" variableName="display" />
                <Constant text="-" />
                <StringOp op="join" style="join">
                  <Constant text="{Ap=" />
                  <StringOp op="friendly" subOp="distance" style="friendly">
                    <CraftProperty property="Orbit.Apoapsis" style="prop-orbit" />
                  </StringOp>
                  <Constant text="}" />
                  <Constant text="" />
                </StringOp>
                <Constant text="" />
              </StringOp>
            </SetVariable>
            <SetVariable id="146" style="set-variable">
              <Variable list="false" local="false" variableName="display" />
              <StringOp op="join" style="join">
                <Variable list="false" local="false" variableName="display" />
                <Constant text="-" />
                <StringOp op="join" style="join">
                  <Constant text="{Pe=" />
                  <StringOp op="friendly" subOp="distance" style="friendly">
                    <CraftProperty property="Orbit.Periapsis" style="prop-orbit" />
                  </StringOp>
                  <Constant text="}" />
                  <Constant text="" />
                </StringOp>
                <Constant text="" />
              </StringOp>
            </SetVariable>
            <SetVariable id="147" style="set-variable">
              <Variable list="false" local="false" variableName="display" />
              <StringOp op="join" style="join">
                <Variable list="false" local="false" variableName="display" />
                <Constant text="-" />
                <StringOp op="join" style="join">
                  <Constant text="{incl=" />
                  <StringOp op="format" style="format">
                    <Constant text="{0:n1}" />
                    <CraftProperty property="Orbit.Inclination" style="prop-orbit" />
                    <Constant text="" />
                  </StringOp>
                  <Constant text="°}" />
                  <Constant text="" />
                </StringOp>
                <Constant text="" />
              </StringOp>
            </SetVariable>
            <DisplayMessage id="148" style="display">
              <Variable list="false" local="false" variableName="display" />
              <Constant number="7" />
            </DisplayMessage>
          </Instructions>
        </ElseIf>
        <WaitSeconds id="149" style="wait-seconds">
          <Constant text="0.1" />
        </WaitSeconds>
      </Instructions>
    </While>
  </Instructions>
  <Instructions>
    <CustomInstruction callFormat="finish" format="finish" name="finish" id="150" style="custom-instruction" pos="-464.6273,-1937.577" />
    <SetVariable id="151" style="set-variable">
      <Variable list="false" local="false" variableName="~PHASE" />
      <Constant text="Finished" />
    </SetVariable>
    <WaitSeconds id="152" style="wait-seconds">
      <Constant text="0.5" />
    </WaitSeconds>
    <CallCustomInstruction call="autopilot" id="153" style="call-custom-instruction">
      <Constant style="false" bool="false" />
    </CallCustomInstruction>
    <CallCustomInstruction call="beep" id="154" style="call-custom-instruction">
      <Constant text="3" />
      <Constant text="700" />
      <Constant text="0.5" />
      <Constant text="0.8" />
    </CallCustomInstruction>
  </Instructions>
  <Instructions>
    <CustomInstruction callFormat="liftoff" format="liftoff" name="liftoff" id="155" style="custom-instruction" pos="-464.7032,-978.7212" />
    <If id="156" style="if">
      <CraftProperty property="Misc.Grounded" style="prop-misc" />
      <Instructions>
        <SetVariable id="157" style="set-variable">
          <Variable list="false" local="false" variableName="~PHASE" />
          <Constant text="Liftoff" />
        </SetVariable>
        <LockNavSphere indicatorType="Current" id="158" style="lock-nav-sphere" />
        <SetTargetHeading property="heading" id="159" style="set-heading">
          <BinaryOp op="-" style="op-sub">
            <Constant text="90" />
            <Variable list="false" local="false" variableName="`inclination" />
          </BinaryOp>
        </SetTargetHeading>
        <SetTargetHeading property="pitch" id="160" style="set-heading">
          <Constant text="90" />
        </SetTargetHeading>
        <SetInput input="throttle" id="161" style="set-input">
          <Constant text="1" />
        </SetInput>
        <ActivateStage id="162" style="activate-stage" />
        <DisplayMessage id="163" style="display">
          <Constant text="Liftoff !" />
          <Constant number="7" />
        </DisplayMessage>
        <CallCustomInstruction call="beep" id="164" style="call-custom-instruction">
          <Constant text="1" />
          <Constant text="1400" />
          <Constant text="0.7" />
          <Constant text="" />
        </CallCustomInstruction>
        <WaitSeconds id="165" style="wait-seconds">
          <Constant text="3" />
        </WaitSeconds>
      </Instructions>
    </If>
  </Instructions>
  <Instructions>
    <CustomInstruction callFormat="flight" format="flight" name="flight" id="166" style="custom-instruction" pos="-464.0185,-1520.14" />
    <BroadcastMessage global="false" local="false" id="167" style="broadcast-msg-craft">
      <Constant text="display" />
      <Constant text="" />
    </BroadcastMessage>
    <SetVariable id="168" style="set-variable">
      <Variable list="false" local="false" variableName="~PHASE" />
      <Constant text="Ascent" />
    </SetVariable>
    <WaitUntil id="169" style="wait-until">
      <Comparison op="g" style="op-gt">
        <CraftProperty property="Vel.SurfaceVelocity" style="prop-velocity" />
        <Constant text="80" />
      </Comparison>
    </WaitUntil>
    <BroadcastMessage global="false" local="false" id="170" style="broadcast-msg-craft">
      <Constant text="staging" />
      <Constant text="" />
    </BroadcastMessage>
    <CallCustomInstruction call="ascent" id="171" style="call-custom-instruction" />
    <CallCustomInstruction call="circularize" id="172" style="call-custom-instruction" />
    <CallCustomInstruction call="finish" id="173" style="call-custom-instruction" />
  </Instructions>
  <Instructions>
    <CustomInstruction callFormat="beep (0) times at (1) Hz for (2) / (3) s" format="beep |n| times at |f| Hz for |d| / |w| s" name="beep" id="174" style="custom-instruction" pos="-462.3469,-4655.677" />
    <Repeat id="175" style="repeat">
      <Conditional style="conditional">
        <Variable list="false" local="true" variableName="n" />
        <Variable list="false" local="true" variableName="n" />
        <Constant text="1" />
      </Conditional>
      <Instructions>
        <SetCraftProperty property="Sound.Beep" id="176" style="play-beep">
          <Conditional style="conditional">
            <Variable list="false" local="true" variableName="f" />
            <Variable list="false" local="true" variableName="f" />
            <Constant text="1000" />
          </Conditional>
          <Constant number="1" />
          <Conditional style="conditional">
            <Variable list="false" local="true" variableName="d" />
            <Variable list="false" local="true" variableName="d" />
            <Constant text="0.05" />
          </Conditional>
        </SetCraftProperty>
        <WaitSeconds id="177" style="wait-seconds">
          <Conditional style="conditional">
            <Variable list="false" local="true" variableName="w" />
            <Variable list="false" local="true" variableName="w" />
            <Constant text="0.1" />
          </Conditional>
        </WaitSeconds>
      </Instructions>
    </Repeat>
  </Instructions>
  <Instructions>
    <Comment id="178" style="comment" pos="-464.1263,238.1944">
      <Constant style="comment-text" canReplace="false" text="Ascent 5.4" />
    </Comment>
    <Comment id="179" style="comment">
      <Constant style="comment-text" canReplace="false" text="1. set Slider 1 to over +0.7 to set an auto circular orbit of 90km" />
    </Comment>
    <Comment id="180" style="comment">
      <Constant style="comment-text" canReplace="false" text="    or set Slider 1 to between +0.2 and +0.7 to set a custom orbit. Cannot be changed." />
    </Comment>
    <Comment id="181" style="comment">
      <Constant style="comment-text" canReplace="false" text="2. set Throttle to over 0.5 to start the automatic ascent to the set orbit" />
    </Comment>
    <Comment id="182" style="comment" pos="-489.4854,85.50952">
      <Constant style="comment-text" canReplace="false" text="3. while in flight, set Slider 1 to &lt;-0.7 to fully stop the auto ascent, or to &lt;+0.2 to pause it and take manual control" />
    </Comment>
  </Instructions>
  <Instructions>
    <Comment id="183" style="comment" pos="2766.486,367.8113">
      <Constant style="comment-text" canReplace="false" text="Changelog" />
    </Comment>
    <Comment id="184" style="comment">
      <Constant style="comment-text" canReplace="false" text="v5.4: added instructions on how to use the program" />
    </Comment>
    <Comment id="185" style="comment">
      <Constant style="comment-text" canReplace="false" text="v5.3: now final “in space” message shows; enforced circ burn at the end if the burn, where Ap can shift a lot for a circular orbit" />
    </Comment>
    <Comment id="186" style="comment">
      <Constant style="comment-text" canReplace="false" text="v5.2: added version info in the program" />
    </Comment>
    <Comment id="187" style="comment" pos="2831.854,103.0165">
      <Constant style="comment-text" canReplace="false" text="v5.0: better burn time estimation for circularization" />
    </Comment>
    <Comment id="188" style="comment">
      <Constant style="comment-text" canReplace="false" text="v5.0: added beeps" />
    </Comment>
  </Instructions>
  <Expressions>
    <Constant pos="470.0816,-1743.343" bool="false" />
    <Constant pos="1443.49,-781.4731" text="" />
    <Constant pos="442.837,-719.1028" bool="true" />
    <Constant pos="1624.549,-1013.066" bool="false" />
    <Constant pos="1332.579,-1013.067" number="-0" />
    <Constant pos="367.6328,-1595.143" text="" />
    <Constant pos="570.0816,-1693.343" bool="false" />
    <Constant pos="1543.49,-731.4731" text="" />
    <Constant pos="1026.183,-224.6898" text="" />
    <CustomExpression callFormat="Pe" format="Pe return (0)" name="Pe" style="custom-expression" pos="-462.9803,-3918.239">
      <Conditional style="conditional">
        <CraftProperty property="Orbit.Periapsis" style="prop-orbit" />
        <CraftProperty property="Orbit.Periapsis" style="prop-orbit" />
        <CallCustomExpression call="Pe~" style="call-custom-expression">
          <CallCustomExpression call="Ap" style="call-custom-expression" />
        </CallCustomExpression>
      </Conditional>
    </CustomExpression>
    <CustomExpression callFormat="Pe~ (0) " format="Pe~ |Ap|  return (0)" name="Pe~" style="custom-expression" pos="-464.541,-3989.971">
      <BinaryOp op="-" style="op-sub">
        <BinaryOp op="*" style="op-mul">
          <BinaryOp op="+" style="op-add">
            <Variable list="false" local="true" variableName="Ap" />
            <Planet op="radius" style="planet">
              <CraftProperty property="Orbit.Planet" style="prop-name" />
            </Planet>
          </BinaryOp>
          <BinaryOp op="/" style="op-div">
            <BinaryOp op="-" style="op-sub">
              <Constant text="1" />
              <CraftProperty property="Orbit.Eccentricity" style="prop-orbit" />
            </BinaryOp>
            <BinaryOp op="+" style="op-add">
              <Constant text="1" />
              <CraftProperty property="Orbit.Eccentricity" style="prop-orbit" />
            </BinaryOp>
          </BinaryOp>
        </BinaryOp>
        <Planet op="radius" style="planet">
          <CraftProperty property="Orbit.Planet" style="prop-name" />
        </Planet>
      </BinaryOp>
    </CustomExpression>
    <CustomExpression callFormat="Ap" format="Ap return (0)" name="Ap" style="custom-expression" pos="-463.7887,-3861.614">
      <CraftProperty property="Orbit.Apoapsis" style="prop-orbit" />
    </CustomExpression>
    <CustomExpression callFormat="isnan (0) " format="isnan |value|  return (0)" name="isnan" style="custom-expression" pos="-467.4225,-4584.78">
      <BoolOp op="and" style="op-and">
        <Comparison op="=" style="op-eq">
          <StringOp op="length" style="length">
            <Variable list="false" local="true" variableName="value" />
          </StringOp>
          <Constant text="3" />
        </Comparison>
        <StringOp op="contains" style="contains">
          <Variable list="false" local="true" variableName="value" />
          <Constant text="NaN" />
        </StringOp>
      </BoolOp>
    </CustomExpression>
    <CustomExpression callFormat="ascent angle" format="ascent angle return (0)" name="ascent angle" style="custom-expression" pos="1996.62,-1648.576">
      <BinaryOp op="max" style="op-max">
        <MathFunction function="rad2deg" style="op-math">
          <MathFunction function="acos" style="op-math">
            <BinaryOp op="min" style="op-min">
              <Constant text="1" />
              <BinaryOp op="^" style="op-exp">
                <BinaryOp op="/" style="op-div">
                  <CraftProperty property="Orbit.Apoapsis" style="prop-orbit" />
                  <BinaryOp op="*" style="op-mul">
                    <Constant text="0.75" />
                    <Variable list="false" local="false" variableName="`Ap" />
                  </BinaryOp>
                </BinaryOp>
                <Variable list="false" local="false" variableName="`ascent_angle_k" />
              </BinaryOp>
            </BinaryOp>
          </MathFunction>
        </MathFunction>
        <BinaryOp op="*" style="op-mul">
          <Constant text="15" />
          <BinaryOp op="^" style="op-exp">
            <Constant text="0.95" />
            <CraftProperty property="Orbit.TimeToApoapsis" style="prop-orbit" />
          </BinaryOp>
        </BinaryOp>
      </BinaryOp>
    </CustomExpression>
    <CustomExpression callFormat="ascent thrust" format="ascent thrust return (0)" name="ascent thrust" style="custom-expression" pos="2000.814,-1758.492">
      <BinaryOp op="*" style="op-mul">
        <BinaryOp op="min" style="op-min">
          <Constant text="1" />
          <BinaryOp op="/" style="op-div">
            <Variable list="false" local="false" variableName="`max_TWR" />
            <BinaryOp op="/" style="op-div">
              <BinaryOp op="/" style="op-div">
                <CraftProperty property="Performance.MaxActiveEngineThrust" style="prop-performance" />
                <VectorOp op="length" style="vec-op-1">
                  <CraftProperty property="Vel.Gravity" style="prop-velocity" />
                </VectorOp>
              </BinaryOp>
              <CraftProperty property="Performance.Mass" style="prop-performance" />
            </BinaryOp>
          </BinaryOp>
        </BinaryOp>
        <BinaryOp op="min" style="op-min">
          <Constant text="1" />
          <BinaryOp op="/" style="op-div">
            <Variable list="false" local="false" variableName="`max_maxQ" />
            <Variable list="false" local="false" variableName="Q" />
          </BinaryOp>
        </BinaryOp>
      </BinaryOp>
    </CustomExpression>
    <BinaryOp op="/" style="op-div" pos="3217.833,-1882.116">
      <CraftProperty property="Altitude.ASL" style="prop-altitude" />
      <BinaryOp op="*" style="op-mul">
        <Constant text="0.7" />
        <Planet op="atmosphereHeight" style="planet">
          <Constant text="Droo" />
        </Planet>
      </BinaryOp>
    </BinaryOp>
    <CustomExpression callFormat="v_orb (0) (1) (2) " format="v_orb |r| |Ap| |Pe|  return (0)" name="v_orb" style="custom-expression" pos="-467.0775,-4081.185">
      <MathFunction function="sqrt" style="op-math">
        <BinaryOp op="*" style="op-mul">
          <BinaryOp op="*" style="op-mul">
            <Variable list="false" local="false" variableName="G™" />
            <Planet op="mass" style="planet">
              <CraftProperty property="Orbit.Planet" style="prop-name" />
            </Planet>
          </BinaryOp>
          <BinaryOp op="-" style="op-sub">
            <BinaryOp op="/" style="op-div">
              <Constant text="2" />
              <BinaryOp op="+" style="op-add">
                <Variable list="false" local="true" variableName="r" />
                <Planet op="radius" style="planet">
                  <CraftProperty property="Orbit.Planet" style="prop-name" />
                </Planet>
              </BinaryOp>
            </BinaryOp>
            <BinaryOp op="/" style="op-div">
              <Constant text="1" />
              <BinaryOp op="+" style="op-add">
                <BinaryOp op="/" style="op-div">
                  <BinaryOp op="+" style="op-add">
                    <Variable list="false" local="true" variableName="Ap" />
                    <Variable list="false" local="true" variableName="Pe" />
                  </BinaryOp>
                  <Constant text="2" />
                </BinaryOp>
                <Planet op="radius" style="planet">
                  <CraftProperty property="Orbit.Planet" style="prop-name" />
                </Planet>
              </BinaryOp>
            </BinaryOp>
          </BinaryOp>
        </BinaryOp>
      </MathFunction>
    </CustomExpression>
    <CustomExpression callFormat="∆t (0) " format="∆t |∆v|  return (0)" name="∆t" style="custom-expression" pos="-464.092,-4174.433">
      <BinaryOp op="*" style="op-mul">
        <BinaryOp op="*" style="op-mul">
          <CraftProperty property="Performance.BurnTime" style="prop-performance" />
          <BinaryOp op="/" style="op-div">
            <CraftProperty property="Performance.Mass" style="prop-performance" />
            <CallCustomExpression call="stage_fuel_mass" style="call-custom-expression" />
          </BinaryOp>
        </BinaryOp>
        <BinaryOp op="-" style="op-sub">
          <Constant text="1" />
          <BinaryOp op="^" style="op-exp">
            <Variable list="false" local="false" variableName="e™" />
            <BinaryOp op="*" style="op-mul">
              <Constant text="-1" />
              <BinaryOp op="/" style="op-div">
                <BinaryOp op="*" style="op-mul">
                  <Variable list="false" local="true" variableName="∆v" />
                  <CallCustomExpression call="stage_fuel_mass" style="call-custom-expression" />
                </BinaryOp>
                <BinaryOp op="*" style="op-mul">
                  <CraftProperty property="Performance.MaxActiveEngineThrust" style="prop-performance" />
                  <CraftProperty property="Performance.BurnTime" style="prop-performance" />
                </BinaryOp>
              </BinaryOp>
            </BinaryOp>
          </BinaryOp>
        </BinaryOp>
      </BinaryOp>
    </CustomExpression>
    <CustomExpression callFormat="∆v_circ (0) " format="∆v_circ |Pe|  return (0)" name="∆v_circ" style="custom-expression" pos="2000.135,-2440.766">
      <BinaryOp op="-" style="op-sub">
        <Conditional style="conditional">
          <Variable list="false" local="true" variableName="Pe" />
          <CallCustomExpression call="v_orb" style="call-custom-expression">
            <CallCustomExpression call="Ap" style="call-custom-expression" />
            <CallCustomExpression call="Ap" style="call-custom-expression" />
            <Variable list="false" local="true" variableName="Pe" />
          </CallCustomExpression>
          <CallCustomExpression call="v_orb" style="call-custom-expression">
            <CallCustomExpression call="Ap" style="call-custom-expression" />
            <CallCustomExpression call="Ap" style="call-custom-expression" />
            <Variable list="false" local="false" variableName="`Pe" />
          </CallCustomExpression>
        </Conditional>
        <CallCustomExpression call="v_orb" style="call-custom-expression">
          <CallCustomExpression call="Ap" style="call-custom-expression" />
          <CallCustomExpression call="Ap" style="call-custom-expression" />
          <CallCustomExpression call="Pe" style="call-custom-expression" />
        </CallCustomExpression>
      </BinaryOp>
    </CustomExpression>
    <CustomExpression callFormat="circ_burntime" format="circ_burntime return (0)" name="circ_burntime" style="custom-expression" pos="1999.972,-2542.033">
      <Conditional style="conditional">
        <Comparison op="l" style="op-lt">
          <CallCustomExpression call="∆v_circ" style="call-custom-expression">
            <Constant text="" />
          </CallCustomExpression>
          <CraftProperty property="Performance.StageDeltaV" style="prop-performance" />
        </Comparison>
        <CallCustomExpression call="∆t" style="call-custom-expression">
          <CallCustomExpression call="∆v_circ" style="call-custom-expression">
            <Constant text="" />
          </CallCustomExpression>
        </CallCustomExpression>
        <BinaryOp op="+" style="op-add">
          <CraftProperty property="Performance.BurnTime" style="prop-performance" />
          <BinaryOp op="*" style="op-mul">
            <Constant text="0.7" />
            <CallCustomExpression call="∆t" style="call-custom-expression">
              <BinaryOp op="-" style="op-sub">
                <CallCustomExpression call="∆v_circ" style="call-custom-expression">
                  <Constant text="" />
                </CallCustomExpression>
                <CraftProperty property="Performance.StageDeltaV" style="prop-performance" />
              </BinaryOp>
            </CallCustomExpression>
          </BinaryOp>
        </BinaryOp>
      </Conditional>
    </CustomExpression>
    <CustomExpression callFormat="circ_now" format="circ_now return (0)" name="circ_now" style="custom-expression" pos="1999.063,-2628.24">
      <BoolOp op="or" style="op-or">
        <Comparison op="l" style="op-lt">
          <CallCustomExpression call="∆v_circ" style="call-custom-expression">
            <Constant text="" />
          </CallCustomExpression>
          <BinaryOp op="*" style="op-mul">
            <Constant text="0.01" />
            <Variable list="false" local="false" variableName="circ_∆V" />
          </BinaryOp>
        </Comparison>
        <BoolOp op="or" style="op-or">
          <Comparison op="l" style="op-lt">
            <CraftProperty property="Orbit.TimeToApoapsis" style="prop-orbit" />
            <BinaryOp op="*" style="op-mul">
              <Constant text="0.5" />
              <CallCustomExpression call="circ_burntime" style="call-custom-expression" />
            </BinaryOp>
          </Comparison>
          <Comparison op="g" style="op-gt">
            <CraftProperty property="Orbit.TimeToApoapsis" style="prop-orbit" />
            <BinaryOp op="*" style="op-mul">
              <Constant text="0.7" />
              <CraftProperty property="Orbit.Period" style="prop-orbit" />
            </BinaryOp>
          </Comparison>
        </BoolOp>
      </BoolOp>
    </CustomExpression>
    <CustomExpression callFormat="stage_fuel_mass" format="stage_fuel_mass return (0)" name="stage_fuel_mass" style="custom-expression" pos="-468.1941,-4507.654">
      <BinaryOp op="*" style="op-mul">
        <CraftProperty property="Fuel.FuelInStage" style="prop-fuel" />
        <Variable list="false" local="false" variableName="stage_fuel_percent_mass" />
      </BinaryOp>
    </CustomExpression>
  </Expressions>
</Program>